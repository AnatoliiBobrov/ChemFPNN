# ChemFPNN
Предсказание растворимости и энергии сольватации с использованием молекулярных отпечатков пальцев

  Рассмотрим способ решения задачи регрессии, использую метод молекулярных отпечатков пальцев по Моргану на наборе данных «ESOL».

  Набор данных ESOL является широко используемым эталонным набором данных в хемоинформатике и машинном обучении для прогнозирования растворимости молекул в воде. Он был представлен статье 2004 года под названием «ESOL: оценка растворимости в воде непосредственно по молекулярной структуре». Набор данных был разработан для обучения и оценки моделей, которые предсказывают растворимость в воде (логарифмическая растворимость в моль/л). Набор содержит 1128 соединений с экспериментально измеренными значениями растворимости.
  
  Вторым набором данных будет «freesolv». Этот набор данных содержит информацию о свободной энергии гидратации химических соединений. Свободная энергия сольватации — это изменение свободной энергии Гиббса при переходе молекул вещества из вакуума в растворитель. 
  
  Для начала работы нам понадобится подключение следующих библиотек:

  Библиотека «csv» — это встроенный модуль, который предоставляет функциональные возможности для чтения из файлов формата CSV (значения, разделенные запятыми) и записи в них. Это упрощает работу с таблич-ными данными за счет автоматической обработки синтаксического анализа и форматирования.

  «json» — это встроенный модуль, предоставляющий функции для работы с данными в формате JSON (JavaScript Object Notation). Она позволяет кодировать объекты Python в строки JSON и декодировать строку JSON обратно в объекты Python.

  «time» — это встроенный модуль, который предоставляет функции для операций, связанных со временем, включая измерение временных интервалов, задержку выполнения и преобразование между форматами времени. Она обычно используется для сравнения производительности.

  «itertools» — это встроенная библиотека, предоставляющая эффективные, экономящие память инструменты для работы с итераторами.

  «RDKit» — это программное обеспечение для хемоинформатики и машинного обучения с открытым исходным кодом, предназначенное для работы с молекулярными данными. Оно предоставляет инструменты для манипу-лирования, анализа и визуализации химических структур, что делает его не-заменимым в разработке лекарств, материаловедении и вычислительной химии.

  «PyTorch» — это платформа машинного обучения с открытым исходным кодом. Она предназначена для гибкого и быстрого создания и обучения моделей глубокого обучения, использующих ускорение графическим про-цессором. 

  «NumPy» — это базовая библиотека для научных вычислений на Python. Она обеспечивает поддержку больших многомерных массивов, а также обширную коллекцию высокоуровневых математических функций для работы с ними.

  «Scikit-learn» — это библиотека машинного обучения с открытым ис-ходным кодом для Python, предназначенная для предоставления простых и эффективных инструментов для интеллектуального анализа данных. 

  Для контроля генераторов случайных величин нужно использовать следующий код:

numpy.random.seed(0)

torch.manual_seed(0)

После настройки генераторов случайных величин можно приступать к чтению данных. Файл «freesolv.csv» со свойствами молекул содержит следующие столбцы:

  •	«iupac» - название вещества по IUPAC;
  
  •	«smiles» - символьное обозначение SMILES;
  
  •	«expt» - экспериментальное значение свободной энергии сольва-тации (кДж/моль);
  
  •	«calc» - вычисленное значение свободной энергии сольватации (кДж/моль);
  
Файл «esol.csv» со свойствами молекул содержит множество столбцов, однако нас интересуют следующие:

  •	«smiles»;
  
  •	«measured log solubility in mols per litre» - экспериментальное значение логарифма растворимости;
  
  •	«ESOL predicted log solubility in mols per litre» - вычисленное зна-чение логарифма растворимости;
  
  Для представления SMILES в виде молекулярного графа, необходимо использовать функцию rdkit.Chem.MolFromSmiles, далее этот молекулярный граф можно представить в виде битового вектора с помощью функции rdkit. AllChem.GetMorganFingerprintAsBitVect. Полученный вектор удобен для по-дачи на вход нейронной сети. Указанная выше функция принимает следую-щие аргументы:

  1)	Молекулярный граф;
  2)	Радиус локальной подструктуры;
  3)	Размерность выходного вектора;
  4)	Другие необязательные параметры.
     
  Теперь, когда подготовлены данные, можно приступать к созданию модели. В нашем исследовании мы использовали перцептрон с тремя слоями. Настройку весов связей в нейронной сети производим методом стохастиче-ского градиентного спуска.

  Для того, чтобы подобрать наилучшие условия обучения нейронной сети, было испытано 2400 сочетаний гиперпараметров нейронной сети:

  1)	Размер вектора-отпечатка пальца молекулы: 2n (n = 4 – 11);
  2)	Радиус отпечатка пальца молекулы: 1 – 6;
  3)	Количество нейронов скрытого слоя: 10n (n = 1 – 10);
  4)	Скорость обучения: 0.0025, 0.005, 0.01, 0.025, 0.05.
     
  После 100 эпох обучения лучшая модель опрошена на тестовом наборе, ошибка составила 1,6459. При этот ошибка вычисления значений в исследовании составила 0,8861. Для «freesolv» ошибка составила 2,3562 против 2.6467 для того же набора в исследовании.
